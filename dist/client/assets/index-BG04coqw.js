import{j as r,r as l,u as re,a as be,b as ve,t as F}from"./main-tOyBsNwM.js";import{$ as U,u as Y,B as q,a as W,c as oe}from"./button-CAN9IdaZ.js";import{I as H}from"./input-BMzC-MGU.js";import{T as Se,f as X,S as we,a as ye,b as je,c as Ce,d as ee,C as Pe,e as Ee,g as Re,h as Te,j as Ne,u as Ae,k as _e,L as M,i as Fe}from"./calendar-BC_WWhex.js";import{l as Le,n as ze,o as De,p as We,a as ke,f as k,i as $,g as L,q as _,r as Me}from"./index-D46EvZwF.js";async function He(e){try{return await U.get(e)}catch(t){throw t}}async function Ie(e){try{return await U.delete(e)}catch(t){throw t}}async function Oe(e,t){try{return await U.post(e,t)}catch(o){throw o}}async function Ue(e,t){try{return await U.post(e,t)}catch(o){throw o}}function $e({deleteMutation:e}){return[{accessorFn:t=>t.filename,id:"filename",header:()=>r.jsx("span",{children:"Title"}),footer:t=>t.column.id,cell:t=>r.jsx("span",{style:{fontSize:"13px",lineHeight:"20px",color:"#111827",fontWeight:"400"},children:t.getValue()??"..."}),size:200},{accessorFn:t=>t.file_type,id:"file_type",header:()=>r.jsx("span",{children:"Type"}),footer:t=>t.column.id,cell:t=>r.jsx("span",{style:{fontSize:"11px",lineHeight:"16px",backgroundColor:"#dbeafe",color:"#1e40af",padding:"2px 8px",borderRadius:"12px",fontWeight:"500",textTransform:"uppercase"},children:t.getValue().split("/").pop()??"..."}),size:120},{accessorFn:t=>t.file_size,id:"file_size",header:()=>r.jsx("span",{children:"Size"}),footer:t=>t.column.id,cell:t=>r.jsx("span",{style:{fontSize:"13px",lineHeight:"20px",color:"#111827",fontWeight:"400"},children:t.getValue()??"..."}),size:120},{accessorFn:t=>t.ragStatus,id:"ragStatus",header:()=>r.jsx("span",{children:"RAG Status"}),footer:t=>t.column.id,cell:t=>{const o=t.getValue()??"UNKNOWN";return r.jsx("span",{style:{fontSize:"11px",lineHeight:"16px",backgroundColor:o==="COMPLETED"?"#dcfce7":"#fef3c7",color:o==="COMPLETED"?"#15803d":"#d97706",padding:"2px 8px",borderRadius:"12px",fontWeight:"500",textTransform:"uppercase"},children:o})},size:150},{accessorFn:t=>t.uploadedAt,id:"uploadedAt",header:()=>r.jsx("span",{children:"Uploaded At"}),footer:t=>t.column.id,cell:t=>{const o=t.getValue()??"";if(!o)return r.jsx("span",{style:{fontSize:"13px",lineHeight:"20px",color:"#111827",fontWeight:"400"},children:"..."});const[n,s,a]=o.split(" ")[0].split("-");return r.jsx("span",{style:{fontSize:"13px",lineHeight:"20px",color:"#111827",fontWeight:"400"},children:`${a}-${s}-${n}`})},size:150},{accessorFn:t=>t.id,id:"actions",header:()=>r.jsx("span",{children:"Actions"}),footer:t=>t.column.id,cell:t=>r.jsx("div",{className:"flex gap-1",children:r.jsx(Se,{style:{width:"16px",height:"16px",color:"#dc2626",cursor:"pointer"},className:"hover:text-red-700 transition-colors",onClick:()=>e.mutate(t.row.original.id)})}),size:80}]}function Be(){const[e,t]=l.useState(1),[o,n]=l.useState(15),[s,a]=l.useState(void 0),[i,d]=l.useState(""),u=re(),{selectedWorkspace:p}=be(),h=ve(),x=c=>{if(!c)return a(void 0);a(Array.isArray(c)?c[0]:c)},{data:f,isPending:v}=Le({queryKey:["files-list",e,o,p?.id,s,i],queryFn:async()=>{const b=`${p?.id?`/files/upload/manual?page=${e}&limit=${o}&user_id=${p?.id}`:`/files/upload/manual?page=${e}&limit=${o}`}${s?`&date=${X(s,"yyyy-MM-dd")}`:""}${i?`&search=${encodeURIComponent(i)}`:""}`,g=await He(b);return g?.status===200||g?.status===201?g.data:(F.error(g?.message||"Files list loading failed..."),g)},refetchOnWindowFocus:!1}),y=Y({mutationKey:["file-delete"],mutationFn:async c=>await Ie(`/files/upload/manual/${c}`),onSuccess:()=>{F.success("File deleted successfully"),u.invalidateQueries({queryKey:["files-list"]}),u.invalidateQueries({queryKey:["stats"]})},onError:c=>{F.error(`Failed to delete file: ${c?.message}`)}});h.navigate({to:"/mainLayout/files",params:{page:e},search:{page:e,limit:o,date:s?X(s,"yyyy-MM-dd"):void 0,search:i}});const N=l.useMemo(()=>!f?.data?.records||!Array.isArray(f.data.records)?[]:f.data.records,[f?.data?.records]),A=f?.data?.paginationInfo,E=l.useMemo(()=>$e({deleteMutation:y}),[]),m=({page:c,limit:b})=>{t(c),n(b)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:gap-0 md:justify-between mr-2",children:[r.jsx("div",{}),r.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-4 items-center py-1",children:[r.jsxs(we,{children:[r.jsx(ye,{className:"w-[180px] bg-white",children:r.jsx(je,{placeholder:"Select"})}),r.jsxs(Ce,{children:[r.jsx(ee,{value:"option1",children:"Option 1"}),r.jsx(ee,{value:"option2",children:"Option 2"})]})]}),r.jsxs(ze,{children:[r.jsx(De,{asChild:!0,children:r.jsxs(q,{variant:"outline",className:`w-[180px] justify-start text-left font-normal ${!s&&"text-muted-foreground"} border-1 border-gray-200`,children:[r.jsx(Pe,{className:"mr-2 h-4 w-4"}),s?X(s,"PPP"):"Select Date"]})}),r.jsx(We,{className:"w-auto p-0",align:"start",children:r.jsx(Ee,{mode:"single",selected:s,onSelect:x,initialFocus:!0})})]}),r.jsxs("div",{className:"relative w-full sm:w-[200px]",children:[r.jsx(Re,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(H,{type:"text",placeholder:"Search",className:"pl-8 bg-white",value:i,onChange:c=>d(c.target.value)})]})]})]}),r.jsx("div",{className:"overflow-hidden",children:r.jsx(Te,{data:N,columns:E,paginationDetails:A||{},getData:m,loading:v,removeSortingForColumnIds:["actions"],heightClass:"h-[calc(100vh-230px)]",noDataLabel:"files",noDataDescription:"No files available",showNoDataIcon:!0})})]})}function Ve({progress:e}){const n=2*Math.PI*12,s=n-e/100*n;return r.jsxs("div",{className:"relative w-8 h-8 flex items-center justify-center",children:[e<100?r.jsxs("svg",{className:"w-6 h-6 rotate-[-90deg]",viewBox:"0 0 32 32",fill:"none",children:[r.jsx("circle",{cx:"16",cy:"16",r:12,stroke:"#e5e7eb",strokeWidth:2.5}),r.jsx("circle",{cx:"16",cy:"16",r:12,stroke:"#3b82f6",strokeWidth:2.5,strokeDasharray:n,strokeDashoffset:s,strokeLinecap:"round"})]}):r.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 flex items-center justify-center",children:r.jsx(Ne,{size:12,strokeWidth:3,className:"text-white"})}),e<100&&r.jsxs("span",{className:"absolute text-[10px] text-blue-600 font-medium",children:[e,"%"]})]})}function Xe(e,t){return l.useReducer((o,n)=>t[o][n]??o,e)}var Q="ScrollArea",[se]=ke(Q),[Ye,P]=se(Q),ne=l.forwardRef((e,t)=>{const{__scopeScrollArea:o,type:n="hover",dir:s,scrollHideDelay:a=600,...i}=e,[d,u]=l.useState(null),[p,h]=l.useState(null),[x,f]=l.useState(null),[v,y]=l.useState(null),[N,A]=l.useState(null),[E,m]=l.useState(0),[c,b]=l.useState(0),[g,S]=l.useState(!1),[j,C]=l.useState(!1),w=W(t,z=>u(z)),R=Ae(s);return r.jsx(Ye,{scope:o,type:n,dir:R,scrollHideDelay:a,scrollArea:d,viewport:p,onViewportChange:h,content:x,onContentChange:f,scrollbarX:v,onScrollbarXChange:y,scrollbarXEnabled:g,onScrollbarXEnabledChange:S,scrollbarY:N,onScrollbarYChange:A,scrollbarYEnabled:j,onScrollbarYEnabledChange:C,onCornerWidthChange:m,onCornerHeightChange:b,children:r.jsx(k.div,{dir:R,...i,ref:w,style:{position:"relative","--radix-scroll-area-corner-width":E+"px","--radix-scroll-area-corner-height":c+"px",...e.style}})})});ne.displayName=Q;var le="ScrollAreaViewport",ae=l.forwardRef((e,t)=>{const{__scopeScrollArea:o,children:n,nonce:s,...a}=e,i=P(le,o),d=l.useRef(null),u=W(t,d,i.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),r.jsx(k.div,{"data-radix-scroll-area-viewport":"",...a,ref:u,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:r.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});ae.displayName=le;var T="ScrollAreaScrollbar",G=l.forwardRef((e,t)=>{const{forceMount:o,...n}=e,s=P(T,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:i}=s,d=e.orientation==="horizontal";return l.useEffect(()=>(d?a(!0):i(!0),()=>{d?a(!1):i(!1)}),[d,a,i]),s.type==="hover"?r.jsx(qe,{...n,ref:t,forceMount:o}):s.type==="scroll"?r.jsx(Ke,{...n,ref:t,forceMount:o}):s.type==="auto"?r.jsx(ie,{...n,ref:t,forceMount:o}):s.type==="always"?r.jsx(J,{...n,ref:t}):null});G.displayName=T;var qe=l.forwardRef((e,t)=>{const{forceMount:o,...n}=e,s=P(T,e.__scopeScrollArea),[a,i]=l.useState(!1);return l.useEffect(()=>{const d=s.scrollArea;let u=0;if(d){const p=()=>{window.clearTimeout(u),i(!0)},h=()=>{u=window.setTimeout(()=>i(!1),s.scrollHideDelay)};return d.addEventListener("pointerenter",p),d.addEventListener("pointerleave",h),()=>{window.clearTimeout(u),d.removeEventListener("pointerenter",p),d.removeEventListener("pointerleave",h)}}},[s.scrollArea,s.scrollHideDelay]),r.jsx($,{present:o||a,children:r.jsx(ie,{"data-state":a?"visible":"hidden",...n,ref:t})})}),Ke=l.forwardRef((e,t)=>{const{forceMount:o,...n}=e,s=P(T,e.__scopeScrollArea),a=e.orientation==="horizontal",i=V(()=>u("SCROLL_END"),100),[d,u]=Xe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return l.useEffect(()=>{if(d==="idle"){const p=window.setTimeout(()=>u("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(p)}},[d,s.scrollHideDelay,u]),l.useEffect(()=>{const p=s.viewport,h=a?"scrollLeft":"scrollTop";if(p){let x=p[h];const f=()=>{const v=p[h];x!==v&&(u("SCROLL"),i()),x=v};return p.addEventListener("scroll",f),()=>p.removeEventListener("scroll",f)}},[s.viewport,a,u,i]),r.jsx($,{present:o||d!=="hidden",children:r.jsx(J,{"data-state":d==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:L(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:L(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),ie=l.forwardRef((e,t)=>{const o=P(T,e.__scopeScrollArea),{forceMount:n,...s}=e,[a,i]=l.useState(!1),d=e.orientation==="horizontal",u=V(()=>{if(o.viewport){const p=o.viewport.offsetWidth<o.viewport.scrollWidth,h=o.viewport.offsetHeight<o.viewport.scrollHeight;i(d?p:h)}},10);return D(o.viewport,u),D(o.content,u),r.jsx($,{present:n||a,children:r.jsx(J,{"data-state":a?"visible":"hidden",...s,ref:t})})}),J=l.forwardRef((e,t)=>{const{orientation:o="vertical",...n}=e,s=P(T,e.__scopeScrollArea),a=l.useRef(null),i=l.useRef(0),[d,u]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=fe(d.viewport,d.content),h={...n,sizes:d,onSizesChange:u,hasThumb:p>0&&p<1,onThumbChange:f=>a.current=f,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:f=>i.current=f};function x(f,v){return tt(f,i.current,d,v)}return o==="horizontal"?r.jsx(Qe,{...h,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const f=s.viewport.scrollLeft,v=te(f,d,s.dir);a.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=x(f,s.dir))}}):o==="vertical"?r.jsx(Ge,{...h,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const f=s.viewport.scrollTop,v=te(f,d);a.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=x(f))}}):null}),Qe=l.forwardRef((e,t)=>{const{sizes:o,onSizesChange:n,...s}=e,a=P(T,e.__scopeScrollArea),[i,d]=l.useState(),u=l.useRef(null),p=W(t,u,a.onScrollbarXChange);return l.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),r.jsx(de,{"data-orientation":"horizontal",...s,ref:p,sizes:o,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":B(o)+"px",...e.style},onThumbPointerDown:h=>e.onThumbPointerDown(h.x),onDragScroll:h=>e.onDragScroll(h.x),onWheelScroll:(h,x)=>{if(a.viewport){const f=a.viewport.scrollLeft+h.deltaX;e.onWheelScroll(f),me(f,x)&&h.preventDefault()}},onResize:()=>{u.current&&a.viewport&&i&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:O(i.paddingLeft),paddingEnd:O(i.paddingRight)}})}})}),Ge=l.forwardRef((e,t)=>{const{sizes:o,onSizesChange:n,...s}=e,a=P(T,e.__scopeScrollArea),[i,d]=l.useState(),u=l.useRef(null),p=W(t,u,a.onScrollbarYChange);return l.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),r.jsx(de,{"data-orientation":"vertical",...s,ref:p,sizes:o,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":B(o)+"px",...e.style},onThumbPointerDown:h=>e.onThumbPointerDown(h.y),onDragScroll:h=>e.onDragScroll(h.y),onWheelScroll:(h,x)=>{if(a.viewport){const f=a.viewport.scrollTop+h.deltaY;e.onWheelScroll(f),me(f,x)&&h.preventDefault()}},onResize:()=>{u.current&&a.viewport&&i&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:O(i.paddingTop),paddingEnd:O(i.paddingBottom)}})}})}),[Je,ce]=se(T),de=l.forwardRef((e,t)=>{const{__scopeScrollArea:o,sizes:n,hasThumb:s,onThumbChange:a,onThumbPointerUp:i,onThumbPointerDown:d,onThumbPositionChange:u,onDragScroll:p,onWheelScroll:h,onResize:x,...f}=e,v=P(T,o),[y,N]=l.useState(null),A=W(t,w=>N(w)),E=l.useRef(null),m=l.useRef(""),c=v.viewport,b=n.content-n.viewport,g=_(h),S=_(u),j=V(x,10);function C(w){if(E.current){const R=w.clientX-E.current.left,z=w.clientY-E.current.top;p({x:R,y:z})}}return l.useEffect(()=>{const w=R=>{const z=R.target;y?.contains(z)&&g(R,b)};return document.addEventListener("wheel",w,{passive:!1}),()=>document.removeEventListener("wheel",w,{passive:!1})},[c,y,b,g]),l.useEffect(S,[n,S]),D(y,j),D(v.content,j),r.jsx(Je,{scope:o,scrollbar:y,hasThumb:s,onThumbChange:_(a),onThumbPointerUp:_(i),onThumbPositionChange:S,onThumbPointerDown:_(d),children:r.jsx(k.div,{...f,ref:A,style:{position:"absolute",...f.style},onPointerDown:L(e.onPointerDown,w=>{w.button===0&&(w.target.setPointerCapture(w.pointerId),E.current=y.getBoundingClientRect(),m.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),C(w))}),onPointerMove:L(e.onPointerMove,C),onPointerUp:L(e.onPointerUp,w=>{const R=w.target;R.hasPointerCapture(w.pointerId)&&R.releasePointerCapture(w.pointerId),document.body.style.webkitUserSelect=m.current,v.viewport&&(v.viewport.style.scrollBehavior=""),E.current=null})})})}),I="ScrollAreaThumb",ue=l.forwardRef((e,t)=>{const{forceMount:o,...n}=e,s=ce(I,e.__scopeScrollArea);return r.jsx($,{present:o||s.hasThumb,children:r.jsx(Ze,{ref:t,...n})})}),Ze=l.forwardRef((e,t)=>{const{__scopeScrollArea:o,style:n,...s}=e,a=P(I,o),i=ce(I,o),{onThumbPositionChange:d}=i,u=W(t,x=>i.onThumbChange(x)),p=l.useRef(void 0),h=V(()=>{p.current&&(p.current(),p.current=void 0)},100);return l.useEffect(()=>{const x=a.viewport;if(x){const f=()=>{if(h(),!p.current){const v=rt(x,d);p.current=v,d()}};return d(),x.addEventListener("scroll",f),()=>x.removeEventListener("scroll",f)}},[a.viewport,h,d]),r.jsx(k.div,{"data-state":i.hasThumb?"visible":"hidden",...s,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:L(e.onPointerDownCapture,x=>{const v=x.target.getBoundingClientRect(),y=x.clientX-v.left,N=x.clientY-v.top;i.onThumbPointerDown({x:y,y:N})}),onPointerUp:L(e.onPointerUp,i.onThumbPointerUp)})});ue.displayName=I;var Z="ScrollAreaCorner",he=l.forwardRef((e,t)=>{const o=P(Z,e.__scopeScrollArea),n=!!(o.scrollbarX&&o.scrollbarY);return o.type!=="scroll"&&n?r.jsx(et,{...e,ref:t}):null});he.displayName=Z;var et=l.forwardRef((e,t)=>{const{__scopeScrollArea:o,...n}=e,s=P(Z,o),[a,i]=l.useState(0),[d,u]=l.useState(0),p=!!(a&&d);return D(s.scrollbarX,()=>{const h=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(h),u(h)}),D(s.scrollbarY,()=>{const h=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(h),i(h)}),p?r.jsx(k.div,{...n,ref:t,style:{width:a,height:d,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function O(e){return e?parseInt(e,10):0}function fe(e,t){const o=e/t;return isNaN(o)?0:o}function B(e){const t=fe(e.viewport,e.content),o=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-o)*t;return Math.max(n,18)}function tt(e,t,o,n="ltr"){const s=B(o),a=s/2,i=t||a,d=s-i,u=o.scrollbar.paddingStart+i,p=o.scrollbar.size-o.scrollbar.paddingEnd-d,h=o.content-o.viewport,x=n==="ltr"?[0,h]:[h*-1,0];return pe([u,p],x)(e)}function te(e,t,o="ltr"){const n=B(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-s,i=t.content-t.viewport,d=a-n,u=o==="ltr"?[0,i]:[i*-1,0],p=_e(e,u);return pe([0,i],[0,d])(p)}function pe(e,t){return o=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(o-e[0])}}function me(e,t){return e>0&&e<t}var rt=(e,t=()=>{})=>{let o={left:e.scrollLeft,top:e.scrollTop},n=0;return(function s(){const a={left:e.scrollLeft,top:e.scrollTop},i=o.left!==a.left,d=o.top!==a.top;(i||d)&&t(),o=a,n=window.requestAnimationFrame(s)})(),()=>window.cancelAnimationFrame(n)};function V(e,t){const o=_(e),n=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(n.current),[]),l.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(o,t)},[o,t])}function D(e,t){const o=_(t);Me(()=>{let n=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(o)});return s.observe(e),()=>{window.cancelAnimationFrame(n),s.unobserve(e)}}},[e,o])}var xe=ne,ot=ae,st=he;const K=l.forwardRef(({className:e,children:t,...o},n)=>r.jsxs(xe,{ref:n,className:oe("relative overflow-hidden",e),...o,children:[r.jsx(ot,{className:"h-full w-full rounded-[inherit]",children:t}),r.jsx(ge,{}),r.jsx(st,{})]}));K.displayName=xe.displayName;const ge=l.forwardRef(({className:e,orientation:t="vertical",...o},n)=>r.jsx(G,{ref:n,orientation:t,className:oe("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...o,children:r.jsx(ue,{className:"relative flex-1 rounded-full bg-gray-200 dark:bg-gray-800"})}));ge.displayName=G.displayName;function nt(){const[e,t]=l.useState([]),[o,n]=l.useState([]),[s,a]=l.useState(""),[i,d]=l.useState([]),u=["application/pdf","image/jpeg","image/png","image/webp","text/html","text/plain"],p=4*1024*1024,h=re(),x=Y({mutationKey:["upload-file"],mutationFn:async m=>{const c=await Ue("/files/upload",m);if(c?.status===200||c?.status===201)return c.data;F.error(`file ${m.file_name} failed to upload in s3`)}}),f=Y({mutationKey:["signed-url-upload"],mutationFn:async m=>{const c=await Oe("/files/upload-files/manual",m);c?.status===200||c?.status===201?(m.files.forEach(b=>y(b.file_name,100,"uploaded")),h.invalidateQueries({queryKey:["files-list"]}),h.invalidateQueries({queryKey:["stats"]}),F.success("All files uploaded successfully"),t([]),d([])):F.error(c?.message||"File upload failed")}}),v=(m,c,b)=>new Promise((g,S)=>{const j=new XMLHttpRequest;j.open("PUT",m),j.setRequestHeader("Content-Type",c.type),j.upload.onprogress=C=>{C.lengthComputable&&b(Math.round(C.loaded/C.total*100))},j.onload=()=>j.status>=200&&j.status<300?g():S(new Error(`Upload failed with status ${j.status}`)),j.onerror=()=>S(new Error("Network error during upload")),j.send(c)}),y=(m,c,b)=>{n(g=>g.map(S=>S.name===m?{...S,progress:c,status:b||S.status}:S).concat(g.some(S=>S.name===m)?[]:[{name:m,progress:c,status:b||"pending"}]))};async function N(m){try{await Promise.all(m.map(async c=>{try{const b=(c.size/1048576).toFixed(2),g=await x.mutateAsync({file_type:c.name.split(".").pop()||"",file_name:c.name,file_size:`${c.size}`});y(c.name,0,"saved");const S=g.data.target_url;await v(S,c,C=>y(c.name,C,"uploading"));const j={file_key:g.data.file_key,file_name:c.name,file_size:`${b}MB`,file_type:c.type};d(C=>[...C,j])}catch(b){F.error(`Error uploading file ${c.name}: ${b.message}`),y(c.name,0,"failed")}}))}catch(c){console.error("Error while uploading",c)}}async function A(){i.length>0&&await f.mutateAsync({files:i})}function E(m){const c=Array.from(m);if(!c.length)return;const b=[];for(let g=0;g<c.length;g++){const S=c[g].type;u.includes(S)&&c[g].size<p?b.push(c[g]):c[g].size>p&&a(`File exceeded the size limit: ${c[g].name}`)}b.length>0&&(a(""),t(g=>[...g,...b]))}return l.useEffect(()=>{if(e.length>0){const m=e.filter(c=>!o.find(b=>b.name===c.name));m.length>0&&N(m)}},[e]),r.jsxs("div",{className:"flex gap-[10px] h-[calc(100vh-140px)] overflow-hidden scrollbar-hide",children:[r.jsx(K,{className:"max-h-[calc(100vh-150px)] overflow-y-auto",children:r.jsx("div",{className:"bg-blue-50 w-[380px] border border-gray-200 ml-2 rounded-sm",children:r.jsxs("div",{className:"flex flex-col gap-4 ml-2 mr-2",children:[r.jsxs("div",{className:"flex flex-col items-center mt-2 justify-center gap-3 border-2 border-dashed border-blue-300 bg-blue-50 rounded-lg w-[360px] h-32 text-center p-2",children:[r.jsx("p",{className:"text-gray-700 text-sm",children:"Drop files or click to browse"}),r.jsx("button",{className:"border-blue-400 border bg-blue-50 text-blue-500 font-medium rounded-md mt-1 px-4 py-1 hover:cursor-pointer",children:r.jsxs(M,{htmlFor:"choose-files",className:"cursor-pointer flex items-center gap-2",children:[r.jsx(H,{id:"choose-files",type:"file",className:"hidden",onChange:m=>E(m.target.files??[]),multiple:!0}),r.jsx("span",{className:"text-xs",children:"Choose Files"})]})}),r.jsx("p",{className:"text-xs text-gray-500",children:"PDF, TXT, HTML, JPEG, PNG supported (max 4MB)"})]}),s&&r.jsx("p",{className:"text-xs text-red-500 mt-1",children:s}),e.length>0&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mr-2",children:[r.jsx("p",{className:"text-sm ml-2 font-semibold text-gray-800",children:"Files Results"}),r.jsx(q,{variant:"outline",size:"sm",onClick:()=>{t([]),n([]),d([])},children:"Clear"})]}),r.jsx(K,{className:"max-h-36 overflow-y-auto",children:r.jsx("ul",{className:"space-y-1 mt-2",children:e.map((m,c)=>{const b=o.find(g=>g.name===m.name);return r.jsxs("li",{className:"flex justify-between rounded-lg bg-white p-3 shadow-sm hover:bg-gray-50",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"text-xs text-gray-800",children:m.name}),r.jsxs("span",{className:"text-xs text-gray-500",children:[(m.size/(1024*1024)).toFixed(2),"MB"]})]}),b&&r.jsx(Ve,{progress:b?.progress})]},c)})})}),r.jsxs("div",{className:"bg-blue-50 rounded-lg space-y-2 w-full max-w-md mt-2",children:[r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx(M,{className:"text-sm text-gray-700",children:"Tags"}),r.jsx(H,{placeholder:"Enter Tags",className:"text-sm"})]}),r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx(M,{className:"text-sm text-gray-700",children:"Category"}),r.jsx(H,{placeholder:"Enter Category",className:"text-sm"})]}),r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx(M,{className:"text-sm text-gray-700",children:"Context"}),r.jsx(Fe,{placeholder:"Enter Context",className:"text-sm h-10 resize-none"})]})]}),r.jsx(q,{className:"w-full bg-blue-500 text-sm hover:bg-blue-500",disabled:f.isPending,onClick:()=>{A()},children:f.isPending?"Submitting...":"Submit"})]})]})})}),r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-md shadow-sm flex-1 overflow-x-auto mr-2",children:r.jsx(Be,{})})]})}function ht(){return r.jsx(r.Fragment,{children:r.jsx(nt,{})})}export{ht as component};
